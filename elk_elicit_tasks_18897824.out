/u/sethapun/.bash_profile: line 84: pyenv: command not found
mkdir: cannot create directory â€˜output/elk-as-vincâ€™: No such file or directory
/n/fs/nlp-elk/elk/elk/utils/gpu_utils.py:69: UserWarning: Smart GPU selection not supported when CUDA_VISIBLE_DEVICES is set. Will use all visible devices.
  warnings.warn(
[36mNone[0m: using 'train' for training and 'validation' for validation
Downloading and preparing dataset None/None to /u/sethapun/.cache/huggingface/datasets/generator/default-4ed2d823c14272be/0.0.0...
Generating train split:   0%|          | 0/1000 [00:00<?, ? examples/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [07:38<15:16, 458.29s/it]Loading checkpoint shards:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [07:38<15:16, 458.29s/it]Loading checkpoint shards:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [14:55<07:25, 445.73s/it]Loading checkpoint shards:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [14:55<07:25, 445.78s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [19:37<00:00, 371.10s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [19:37<00:00, 392.51s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [19:37<00:00, 371.11s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [19:37<00:00, 392.52s/it]
Downloading (â€¦)neration_config.json:   0%|          | 0.00/137 [00:00<?, ?B/s]Downloading (â€¦)neration_config.json: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 137/137 [00:00<00:00, 42.9kB/s]
Generating train split:   0%|          | 0/1000 [27:39<?, ? examples/s]multiprocess.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/n/fs/nlp-elk/miniconda3/lib/python3.10/site-packages/datasets/builder.py", line 1610, in _prepare_split_single
    for key, record in generator:
  File "/n/fs/nlp-elk/elk/elk/extraction/generator.py", line 93, in _generate_examples
    for idx, ex in enumerate(self.config.generator(**gen_kwargs)):
  File "/n/fs/nlp-elk/elk/elk/extraction/extraction.py", line 267, in _extraction_worker
    yield from extract_hiddens(**{k: v[0] for k, v in kwargs.items()})
  File "/n/fs/nlp-elk/miniconda3/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 35, in generator_context
    response = gen.send(None)
  File "/n/fs/nlp-elk/elk/elk/extraction/extraction.py", line 114, in extract_hiddens
    ).to(device)
  File "/n/fs/nlp-elk/miniconda3/lib/python3.10/site-packages/transformers/modeling_utils.py", line 1896, in to
    return super().to(*args, **kwargs)
  File "/n/fs/nlp-elk/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1145, in to
    return self._apply(convert)
  File "/n/fs/nlp-elk/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/n/fs/nlp-elk/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/n/fs/nlp-elk/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  [Previous line repeated 2 more times]
  File "/n/fs/nlp-elk/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 820, in _apply
    param_applied = fn(param)
  File "/n/fs/nlp-elk/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1143, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 136.00 MiB (GPU 0; 10.75 GiB total capacity; 10.17 GiB already allocated; 57.62 MiB free; 10.17 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/n/fs/nlp-elk/miniconda3/lib/python3.10/site-packages/multiprocess/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/n/fs/nlp-elk/miniconda3/lib/python3.10/site-packages/datasets/utils/py_utils.py", line 1353, in _write_generator_to_queue
    for i, result in enumerate(func(**kwargs)):
  File "/n/fs/nlp-elk/miniconda3/lib/python3.10/site-packages/datasets/builder.py", line 1646, in _prepare_split_single
    raise DatasetGenerationError("An error occurred while generating the dataset") from e
datasets.builder.DatasetGenerationError: An error occurred while generating the dataset
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/n/fs/nlp-elk/miniconda3/bin/elk", line 8, in <module>
    sys.exit(run())
  File "/n/fs/nlp-elk/elk/elk/__main__.py", line 27, in run
    run.execute()
  File "/n/fs/nlp-elk/elk/elk/__main__.py", line 19, in execute
    return self.command.execute()
  File "/n/fs/nlp-elk/elk/elk/training/train.py", line 59, in execute
    Train(cfg=self, out_dir=self.out_dir).train()
  File "<string>", line 5, in __init__
  File "/n/fs/nlp-elk/elk/elk/run.py", line 40, in __post_init__
    self.datasets = [
  File "/n/fs/nlp-elk/elk/elk/run.py", line 41, in <listcomp>
    extract(
  File "/n/fs/nlp-elk/elk/elk/extraction/extraction.py", line 372, in extract
    builder.download_and_prepare(
  File "/n/fs/nlp-elk/miniconda3/lib/python3.10/site-packages/datasets/builder.py", line 891, in download_and_prepare
    self._download_and_prepare(
  File "/n/fs/nlp-elk/miniconda3/lib/python3.10/site-packages/datasets/builder.py", line 1651, in _download_and_prepare
    super()._download_and_prepare(
  File "/n/fs/nlp-elk/miniconda3/lib/python3.10/site-packages/datasets/builder.py", line 986, in _download_and_prepare
    self._prepare_split(split_generator, **prepare_split_kwargs)
  File "/n/fs/nlp-elk/miniconda3/lib/python3.10/site-packages/datasets/builder.py", line 1518, in _prepare_split
    for job_id, done, content in iflatmap_unordered(
  File "/n/fs/nlp-elk/miniconda3/lib/python3.10/site-packages/datasets/utils/py_utils.py", line 1377, in iflatmap_unordered
    [async_result.get() for async_result in async_results]
  File "/n/fs/nlp-elk/miniconda3/lib/python3.10/site-packages/datasets/utils/py_utils.py", line 1377, in <listcomp>
    [async_result.get() for async_result in async_results]
  File "/n/fs/nlp-elk/miniconda3/lib/python3.10/site-packages/multiprocess/pool.py", line 774, in get
    raise self._value
datasets.builder.DatasetGenerationError: An error occurred while generating the dataset
                                                                       